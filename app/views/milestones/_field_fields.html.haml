%li
  %fieldset.fieldset
    .field-wrapper
      %button.btn.move{type: :button}
        %i.fa.fa-arrows-alt

      .wrapper.flex-row-vertical-center
        %button.btn.collapse-trigger{type: :button}
          %i.fas.fa-caret-right

        .flex1
          = f.hidden_field :field_type, class: 'field-type', 'data-field' => f.object.to_json
          = f.text_field :name, placeholder: "field_name", class: 'form-control field-name'
        .action-wrapper.flex-row-vertical-center
          .form-check
            = f.check_box :required, { class: 'form-check-input field-required' }
            = f.label :required, t('milestone.required'), class: 'form-check-label required-label'
            = f.hidden_field :display_order, class: 'display-order'

          %button.btn.btn-outline-primary.btn-add-field{type: 'button'}= t('milestone.add_field')

      = f.hidden_field :_destroy
      = link_to '#', class: "remove_fields btn-remove-field" do
        %i.fas.fa-trash-alt

    = render 'kinds'

    .collapse-content
      .mapping-field-wrapper
        %label= t('milestone.mapping_to_root')
        .wrapper
          = f.select :mapping_field, options_for_select( Field::roots.map{ |c| [c[:name], c[:code], {'data-field_type'=>c[:field_type], 'data-obj' => c.to_json}]}, selected: f.object.mapping_field), { prompt: 'Select event type field'}, class: 'form-control mapping-field'

          .mapping-field-type-wrapper
            = f.text_field :mapping_field_type, placeholder: "field type", class: 'form-control mapping-field-type'
            .disabled-layer

      .options-wrapper
        = f.fields_for :field_options do |builder|
          = render 'field_option_fields', f: builder
        = link_to_add_fields t('milestone.add_option'), f, :field_options
