#content
  %nav.navbar.navbar-expand-lg.navbar-light.bg-light
    .container-fluid
      %h3 New Event

  .w-50.view-center
    = simple_form_for @event do |f|
      = f.input :event_type_id, as: :hidden

      .form-group
        %label Event Type
        %input.form-control{type: :text, readonly: true, value: @event.event_type_name}


      - form_type = @event.event_type.form_types.first
      - form = @event.forms.first || @event.forms.new

      = f.simple_fields_for :forms, form do |ff|
        = ff.input :submitter_id, input_html: {value: current_user.id}, as: :hidden
        = ff.input :form_type_id, input_html: {value: form_type.id}, as: :hidden

        - form_type.fields.each do |field|
          - obj = form.field_values.select{ |a| a.field_id==field.id }.first || ff.object.field_values.new
          = ff.fields_for :field_values, obj do |builder|
            = render "events/fields/#{field.field_type}", field: field, f: builder

      = f.button :submit, class: 'btn btn-primary'
      = link_to 'Cancel', events_path, class: 'btn btn-secondary'
